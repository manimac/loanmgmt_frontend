<section id="contact" class="contact">
    <div class="container" data-aos="fade-up">
        <div class="section-title">
            <h3><span>Reports</span></h3>
        </div>
        <div class="row mt-3">
            <div class="col-lg-12 mt-2">
                <div class="row">
                    <div class="col-lg-3">
                        <input type="date" [(ngModel)]="fromDate" class="form-control">
                    </div>
                    <div class="col-lg-3">
                        <input type="date" [(ngModel)]="toDate" class="form-control">
                    </div>
                    <div class="col-lg-3">
                        <button (click)="search()" class="btn btn-primary">Search</button>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table table-bordered mt-4">
                        <thead>
                            <tr>
                                <th scope="col"></th>
                                <th scope="col">From</th>
                                <th scope="col">To</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Date</td>
                                <td>{{fromDate | date: 'dd-MM-yyyy'}}</td>
                                <td>{{toDate | date: 'dd-MM-yyyy'}}</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td>No of Trans</td>
                                <td>Amount</td>
                            </tr>
                            <tr>
                                <td>New Loans</td>
                                <td>{{loanTable.newLoansTrans ? loanTable.newLoansTrans : 0}}</td>
                                <td>{{loanTable.newLoansAmount ? loanTable.newLoansAmount : 0}}</td>
                            </tr>
                            <tr>
                                <td>Loan Repayments</td>
                                <td>{{loanTable.loanRepaymentsTrans ? loanTable.loanRepaymentsTrans : 0}}</td>
                                <td>{{loanTable.loanRepaymentsAmount ? loanTable.loanRepaymentsAmount : 0}}</td>
                            </tr>
                            <tr>
                                <td>Unit Purchased</td>
                                <td>{{loanTable.unitPurchasedTrans ? loanTable.unitPurchasedTrans : 0}}</td>
                                <td>{{loanTable.unitPurchasedAmount ? loanTable.unitPurchasedAmount : 0}}</td>
                            </tr>
                            <tr>
                                <td>Unit Redeemed</td>
                                <td>{{loanTable.unitRedeemedTrans ? loanTable.unitRedeemedTrans : 0}}</td>
                                <td>{{loanTable.unitRedeemedAmount ? loanTable.unitRedeemedAmount : 0}}</td>
                            </tr>
                            <tr>
                                <td>Deposited</td>
                                <td>{{loanTable.depositedTrans ? loanTable.depositedTrans : 0}}</td>
                                <td>{{loanTable.depositedAmount ? loanTable.depositedAmount : 0}}</td>
                            </tr>
                            <tr>
                                <td>Withdrawn</td>
                                <td>{{loanTable.withdrawnTrans ? loanTable.withdrawnTrans : 0}}</td>
                                <td>{{loanTable.withdrawnAmount ? loanTable.withdrawnAmount : 0}}</td>
                            </tr>
                            <tr>
                                <td>No of Active Loan</td>
                                <td>{{loanTable.activeLoan ? loanTable.activeLoan : 0}}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Active Loan Amount</td>
                                <td>{{loanTable.activeLoanAmount ? loanTable.activeLoanAmount : 0}}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Active Loan Interest</td>
                                <td>{{loanTable.activeLoanInterest ? loanTable.activeLoanInterest : 0}}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Total Loan + Int</td>
                                <td>{{loanTable.totalLoanInterest ? loanTable.totalLoanInterest : 0}}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Cash</td>
                                <td [innerHtml]="getCash(loanTable)"></td>
                                <td><button class="btn btn-primary" *ngIf="userRole=='Admin'" (click)="openModal(paymentform, 'cash')">Withdraw</button></td>
                            </tr>
                            <tr>
                                <td>Bank</td>
                                <td [innerHtml]="getBank(loanTable)"></td>
                                <td><button class="btn btn-primary" *ngIf="userRole=='Admin'" (click)="openModal(paymentform, 'bank')">Deposit</button></td>
                            </tr>
                            <tr>
                                <td>Net Asset</td>
                                <td>{{loanTable.netAsset ? loanTable.netAsset : 0}}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>No Of Overdue</td>
                                <td>{{loanTable.noOfOverdue ? loanTable.noOfOverdue : 0}}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Overdue Principle</td>
                                <td>{{loanTable.overduePrinciple ? loanTable.overduePrinciple : 0}}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Overdue Interest</td>
                                <td>{{loanTable.overdueInterest ? loanTable.overdueInterest : 0}}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Total Overdue Amount</td>
                                <td>{{loanTable.totalOverdue ? loanTable.totalOverdue : 0}}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>No of Investments</td>
                                <td>{{loanTable.noOfInvestments ? loanTable.noOfInvestments : 0}}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>No of Units</td>
                                <td>{{loanTable.noOfUnits ? loanTable.noOfUnits : 0}}</td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Unit Rate</td>
                                <td>{{loanTable.unitRate ? loanTable.unitRate : 0}}</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
            </div>
        </div>
    </div>
</section>

<ng-template #paymentform>
    <div class="modal-header">
       <h4 class="modal-title pull-left">Add {{paymentType|uppercase}}</h4>
       <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
          <span aria-hidden="true">Ã—</span>
       </button>
    </div>
    <div class="modal-body">
        <form [formGroup]="paymentFormGroup">
            <div class="row">
                <div class="col-lg-12">
                    <div class="form-group">
                        <label>Amount:</label>
                        <input type="text" class="form-control" formControlName="value">
                    </div>
                </div>
            </div>
        </form>  
    </div>
    <div class="modal-footer" [formGroup]="paymentFormGroup">
       <button type="button" class="btn btn-primary" (click)="savepayment()" [disabled]="paymentFormGroup.invalid">Save</button>
    </div>
 </ng-template>